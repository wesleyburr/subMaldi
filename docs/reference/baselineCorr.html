<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Baseline Correction — baselineCorr • subMALDI</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Baseline Correction — baselineCorr" />
<meta property="og:description" content="Offers three different methods for baseline correction of raw spectral
data. Methods include monotone minimum, linear interpolation, and LOESS
curve fitting." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">subMALDI</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0-3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/subMALDI_workflow.html">subMALDI: Sample Workflow</a>
    </li>
    <li>
      <a href="../articles/subMALDIprocessing.html">Processing with subMALDI</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Baseline Correction</h1>
    
    <div class="hidden name"><code>baselineCorr.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Offers three different methods for baseline correction of raw spectral
data. Methods include monotone minimum, linear interpolation, and LOESS
curve fitting.</p>
    </div>

    <pre class="usage"><span class='fu'>baselineCorr</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>mass_dat</span>, <span class='va'>intensity_dat</span>, method <span class='op'>=</span> <span class='cn'>NULL</span>, n <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dat</th>
      <td><p>The name of the spectral data frame, containing <code>m/z</code> data
in the first column and spectral intensity data in subsequent columns.</p></td>
    </tr>
    <tr>
      <th>mass_dat</th>
      <td><p>Character string. The name of the column in <code>dat</code>
containing the <em>m/z</em> data for the spectrum that will be corrected.</p></td>
    </tr>
    <tr>
      <th>intensity_dat</th>
      <td><p>Character string. The name of the column in <code>dat</code>
containing the intensity data for the spectrum to be baseline corrected.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Character string. The method that is to be used to perform
the baseline correction. Either <code>"monotone"</code> for monotone minimum
correction, <code>"linear"</code> for linear interpolation, or <code>"loess"</code> for
LOESS curve fitting.</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>Single odd numeric value. If <code>method = "linear"</code>, the size of
the window that should be used for linear interpolation of the spectral
baseline.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a new data frame containing the baseline corrected spectral
data.</p>
    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    <p></p><dl>
<dt>monotone_min</dt><dd><p>Identifies valleys in the
spectrum by evaluating the slopes between adjacent intensity values. Moving
from left to right, if slope of point A is greater than 0, the nearest
point B with slope of less than 0 is located. Points in between A and B are
recorded as potential peaks. If slope of A &lt; 0, nearest point B with slope
&gt; 0 is located. Points between A and B are recorded as valleys. Each
intensity value in the spectrum is then subtracted by the intensity of the
nearest valley, correcting any irregularities in the baseline of the data.</p></dd> <dt>linear</dt><dd><p>Divides a spectrum into small segments and evaluates the
mean of points in each segment as a valley (1). A baseline is then
generated by linearly interpolating valleys across all small segments. In
each segment, the intensity of each peak is subtracted by the intensity of
the valley in that segment.</p></dd> <dt>loess</dt><dd><p>Divides a spectrum into small
segments and evaluates the quantile in each segment. The baseline is
estimated as follows. If the intensity of point A in a segment is less than
the quantile, the intensity of point A is recorded as a baseline predictor
for that point. If the intensity of point A is greater than or equal to the
quantile in the segment, the quantile for the segment is recorded the
baseline predictor for that point. Local polynomial regression fitting is
applied to the predictor points. The baseline is then subtracted from the
raw spectral signal.</p></dd> 
</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>https://github.com/wesleyburr/subMaldi (1) Yang, C., He, Z. &amp;
Yu, W. Comparison of public peak detection algorithms for MALDI mass
spectrometry data analysis. BMC Bioinformatics 10, 4 (2009).
https://doi.org/10.1186/1471-2105-10-4</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='smoothSpectrum.html'>smoothSpectrum</a></code>, <code><a href='peakDet.html'>peakDet</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Kristen Yeh &lt;kristenyeh@trentu.ca&gt; Wesley Burr &lt;wesleyburr@trentu.ca&gt;</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Load sample dataset "bsline"</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"bsline"</span><span class='op'>)</span>

<span class='co'>## Correct the baseline using the monotone minimum method</span>
<span class='va'>bsline_mono</span> <span class='op'>&lt;-</span> <span class='fu'>baselineCorr</span><span class='op'>(</span><span class='va'>bsline</span>, <span class='st'>"mass"</span>, <span class='st'>"raw"</span>, 
                      method <span class='op'>=</span> <span class='st'>"monotone_min"</span><span class='op'>)</span>

<span class='co'>## Correct the baseline using the linear interpolation method</span>
<span class='co'>## Window size of 7</span>
<span class='va'>bsline_linear</span> <span class='op'>&lt;-</span> <span class='fu'>baselineCorr</span><span class='op'>(</span><span class='va'>bsline</span>, <span class='st'>"mass"</span>, <span class='st'>"raw"</span>, 
                      method <span class='op'>=</span> <span class='st'>"linear"</span>, n <span class='op'>=</span> <span class='fl'>7</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Wesley Burr.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


