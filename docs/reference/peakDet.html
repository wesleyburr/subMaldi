<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Peak Detection — peakDet • subMALDI</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Peak Detection — peakDet" />
<meta property="og:description" content="Two methods for peak detection in baseline corrected spectral data. Methods
include signal-to-noise ratio and slopes of peaks." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">subMALDI</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/subMALDI_workflow.html">subMALDI: Sample Workflow</a>
    </li>
    <li>
      <a href="../articles/subMALDIprocessing.html">Processing with subMALDI</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Peak Detection</h1>
    
    <div class="hidden name"><code>peakDet.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Two methods for peak detection in baseline corrected spectral data. Methods
include signal-to-noise ratio and slopes of peaks.</p>
    </div>

    <pre class="usage"><span class='fu'>peakDet</span><span class='op'>(</span>
  <span class='va'>dat</span>,
  <span class='va'>mass_dat</span>,
  <span class='va'>intensity_dat</span>,
  method <span class='op'>=</span> <span class='cn'>NULL</span>,
  n <span class='op'>=</span> <span class='cn'>NULL</span>,
  SNR_thresh <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dat</th>
      <td><p>The name of the spectral data frame, containing <code>m/z</code> data
in the first column and spectral intensity data in subsequent columns.</p></td>
    </tr>
    <tr>
      <th>mass_dat</th>
      <td><p>Character string. The name of the column in <code>dat</code>
containing the <em>m/z</em> data for the spectrum.</p></td>
    </tr>
    <tr>
      <th>intensity_dat</th>
      <td><p>Character string. The name of the column in <code>dat</code>
containing the intensity data for the spectrum.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Character string. The method of peak detection. Either
<code>"snr"</code> for signal-to-noise ratio, or <code>"slopes"</code> for slopes of
peaks.</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>Single numeric value. For both <code>method = "snr"</code> and
<code>method = "slopes"</code>, the window size used to calculate noise. Noise is
defined as the median of the absolute deviation (MAD) of points within a
window [1].</p></td>
    </tr>
    <tr>
      <th>SNR_thresh</th>
      <td><p>Single numeric value. When <code>method = "snr"</code>, the
signal-to-noise ratio (SNR) threshold for discarding peaks. If the SNR of a
peak falls below this threshold, it will be discarded.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a new data frame containing only the peaks which have
passed the detection criteria.</p>
    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    <p></p><dl>
<dt>snr</dt><dd><p>Each spectrum is divided into
segments of size <code>n</code>. Noise is calculated as the median absolute
deviation of points within each segment [1]. If the intensity of a peak
divided by the noise in that segment is less than the indicated
<code>SNR_thresh</code>, the peak is discarded.</p></dd> <dt>slopes</dt><dd><p>Uses the shapes
of peaks to remove false peak candidates [1]. First, the left and right
endpoints of each peak are identified on the baseline. Next, the slopes of
each endpoint are evaluated. If the either the left or right slope are less
than a defined threshold, the peak candidate is discarded [1]. The
threshold is defined as half of the local noise level, or half of the
median absolute deviation in a window of size <code>n</code>.</p></dd> 
</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>https://github.com/wesleyburr/subMaldi (1) Yang, C., He, Z. &amp;
Yu, W. Comparison of public peak detection algorithms for MALDI mass
spectrometry data analysis. BMC Bioinformatics 10, 4 (2009).
https://doi.org/10.1186/1471-2105-10-4</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='smoothSpectrum.html'>smoothSpectrum</a></code>, <code><a href='baselineCorr.html'>baselineCorr</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Kristen Yeh &lt;kristenyeh@trentu.ca&gt; Wesley Burr &lt;wburr@trentu.ca&gt;</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Load sample dataset "bsline"</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"bsline"</span><span class='op'>)</span>

<span class='co'>## Baseline correct using method "linear"</span>
<span class='va'>linear</span> <span class='op'>&lt;-</span> <span class='fu'><a href='baselineCorr.html'>baselineCorr</a></span><span class='op'>(</span><span class='va'>bsline</span>, <span class='st'>"mass"</span>, <span class='st'>"raw"</span>, 
                        method <span class='op'>=</span> <span class='st'>"linear"</span>, n <span class='op'>=</span> <span class='fl'>7</span><span class='op'>)</span>

<span class='co'>## Detect peaks using method "snr"</span>
<span class='va'>snr</span> <span class='op'>&lt;-</span> <span class='fu'>peakDet</span><span class='op'>(</span><span class='va'>linear</span>, <span class='st'>"mz"</span>, <span class='st'>"baseline"</span>, method <span class='op'>=</span> <span class='st'>"snr"</span>, 
                  n <span class='op'>=</span> <span class='fl'>7</span>, SNR_thresh <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>17725 peaks removed below SNR_thresh = 3</span></div><div class='input'>
<span class='co'>## Detect peaks using method "slopes"</span>
<span class='va'>slopes</span> <span class='op'>&lt;-</span> <span class='fu'>peakDet</span><span class='op'>(</span><span class='va'>linear</span>, <span class='st'>"mz"</span>, <span class='st'>"baseline"</span>, method <span class='op'>=</span> <span class='st'>"slopes"</span>,
                    n <span class='op'>=</span> <span class='fl'>7</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Wesley Burr.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9000.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


