head(norm_spec)
dim(norm_spec)
plotSpectra(norm_spec, mass_dat = "full_mz", spectra_cols = c("Before1", "Before2"), x_ticks = 5)
norm_spec <- subset(norm_spec, full_mz >= 53.76 & full_mz <= 800)
plotSpectra(norm_spec, mass_dat = "full_mz", spectra_cols = c("Before1", "Before2"), x_ticks = 5)
custom_ex <- normSpectra(norm_spec, mass_dat = "full_mz", method = "custom",
norm_mz = 255.23, spectra_cols = c("Before1", "Before2"))
plotSpectra(norm_spec,mass_dat = "full_mz", spectra_cols = c("Before1", "Before2"), x_ticks = 5)
plotSpectra(custom_ex, mass_dat = "full_mz", spectra_cols = c("Before1", "Before2"), x_ticks = 5, palette = "Accent")
str(mass_dat)
detach("package:subMALDI", unload = TRUE)
library("subMALDI")
library("dplyr")
select
select()
dplyr::select()
transform
?select
?transform
detach("package:subMALDI", unload = TRUE)
library("subMALDI")
?colorRampPalette
?read.table
roxygen::roxygenise()
roxygen::roxygenise()
library("roxygen")
library("roxygen2")
roxygen2::roxygenise()
setwd("~/src/subMaldi/R")
roxygen2::roxygenise()
getwd()
setwd("../")
roxygen2::roxygenise()
rm(list=c("plotSpectra"))
roxygen2::roxygenise()
library("pkgdown")
install.packages("pkgdown")
install.packages("pkgdown")
install.packages("ragg")
devtools::install_github("r-lib/textshaping")
install.packages("ragg")
install.packages("ragg")
install.packages("pkgdown")
pkgdown::build_site()
pkgdown::build_site()
?mutate
row_number
?row_number
data(Master)
## Separate samples
blanks <- select(Master, "full_mz", "Blank1", "Blank2")
precon <- select(Master, "full_mz", "Before1", "Before2")
postcon <- select(Master, "full_mz", "After1", "After2")
pkgname <- "subMALDI"
pkgname <- "subMALDI"
pkgname <- "subMALDI"
source(file.path(R.home("share"), "R", "examples-header.R"))
options(warn = 1)
library('subMALDI')
base::assign(".oldSearch", base::search(), pos = 'CheckExEnv')
base::assign(".old_wd", base::getwd(), pos = 'CheckExEnv')
cleanEx()
nameEx("After1")
### * After1
flush(stderr()); flush(stdout())
### Name: After1
### Title: Pairwise Spectral Data Frame from Sample
### Aliases: After1
### Keywords: datasets
### ** Examples
data(After1)
cleanEx()
nameEx("After2")
### * After2
flush(stderr()); flush(stdout())
### Name: After2
### Title: Pairwise Spectral Data Frame from Sample
### Aliases: After2
### Keywords: datasets
### ** Examples
data(After2)
cleanEx()
nameEx("Before1")
### * Before1
flush(stderr()); flush(stdout())
### Name: Before1
### Title: Pairwise Spectral Data Frame from Sample
### Aliases: Before1
### Keywords: datasets
### ** Examples
data(Before1)
cleanEx()
nameEx("Before2")
### * Before2
flush(stderr()); flush(stdout())
### Name: Before2
### Title: Pairwise Spectral Data Frame from Sample
### Aliases: Before2
### Keywords: datasets
### ** Examples
data(Before2)
cleanEx()
nameEx("Blank1")
### * Blank1
flush(stderr()); flush(stdout())
### Name: Blank1
### Title: Pairwise Spectral Data from Matrix Blank
### Aliases: Blank1
### Keywords: datasets
### ** Examples
data(Blank1)
cleanEx()
nameEx("Blank2")
### * Blank2
flush(stderr()); flush(stdout())
### Name: Blank2
### Title: Pairwise Spectral Data from Matrix Blank
### Aliases: Blank2
### Keywords: datasets
### ** Examples
data(Blank2)
cleanEx()
nameEx("Master")
### * Master
flush(stderr()); flush(stdout())
### Name: Master
### Title: Master Data Frame (High Resolution)
### Aliases: Master
### Keywords: datasets
### ** Examples
data(Master)
## Separate samples
blanks <- dplyr::select(Master, "full_mz", "Blank1", "Blank2")
precon <- dplyr::select(Master, "full_mz", "Before1", "Before2")
postcon <- dplyr::select(Master, "full_mz", "After1", "After2")
cleanEx()
nameEx("Master2")
### * Master2
flush(stderr()); flush(stdout())
### Name: Master2
### Title: Master Data Frame (Low Resolution)
### Aliases: Master2
### Keywords: datasets
### ** Examples
data(Master2)
data(Master)
## Separate samples
blanks <- dplyr::select(Master2, "full_mz", "Blank1", "Blank2")
precon <- dplyr::select(Master2, "full_mz", "Before1", "Before2")
postcon <- dplyr::select(Master2, "full_mz", "After1", "After2")
cleanEx()
nameEx("avgSpectra")
### * avgSpectra
flush(stderr()); flush(stdout())
### Name: avgSpectra
### Title: Average Spectral Replicates
### Aliases: avgSpectra
### Keywords: manip methods
### ** Examples
## Load sample dataset "Master.rda"
data("Master")
## Average blank spectrum 1 and 2 using the method "mean"
ex <- avgSpectra(Master, method = "mean", spectra_cols = c("Blank1", "Blank2"))
## Average blank spectrum 1 and 2 using the method "sum"
ex <- avgSpectra(Master, method = "sum", spectra_cols = c("Blank1", "Blank2"))
cleanEx()
nameEx("baselineCorr")
### * baselineCorr
flush(stderr()); flush(stdout())
### Name: baselineCorr
### Title: Baseline Correction
### Aliases: baselineCorr
### Keywords: manip methods
### ** Examples
## Load sample dataset "bsline"
data("bsline")
## Correct the baseline using the monotone minimum method
bsline_mono <- baselineCorr(bsline, "mass", "raw",
method = "monotone_min")
## Correct the baseline using the linear interpolation method
## Window size of 7
bsline_linear <- baselineCorr(bsline, "mass", "raw",
method = "linear", n = 7)
cleanEx()
nameEx("bsline")
### * bsline
flush(stderr()); flush(stdout())
### Name: bsline
### Title: Raw Spectrum with Irregular Baseline
### Aliases: bsline
### Keywords: datasets
### ** Examples
data(bsline)
cleanEx()
nameEx("createSpecDF")
### * createSpecDF
flush(stderr()); flush(stdout())
### Name: createSpecDF
### Title: Create Empty Spectral Data Frame
### Aliases: createSpecDF
### Keywords: array methods
### ** Examples
## Creating an empty spectrum with an m/z range of 500 to 2000 m/z, with a step size of 0.001
spec_df <- createSpecDF(min_mz = 500, max_mz = 2000, res = 0.001, dig = 3)
## Creating an empty spectrum with an m/z range of 100 to 1000,
# with a step size of 0.0001 and sample names
spec_df <- createSpecDF(min_mz = 100, max_mz = 1000, res = 0.0001, dig = 4)
cleanEx()
nameEx("find_max")
### * find_max
flush(stderr()); flush(stdout())
### Name: find_max
### Title: Find Peak Maxima
### Aliases: find_max
### Keywords: methods
### ** Examples
## Load sample dataset "Master.rda"
data("Master")
## Find maxima of four spectra
find_max(dat = Master, mass_dat = "full_mz", spectra_cols = c("Blank1", "Before1", "After1", "After2")
cleanEx()
nameEx("find_max_set")
### * find_max_set
flush(stderr()); flush(stdout())
### Name: find_max_set
### Title: Find Most Intense Peak of a Set
### Aliases: find_max_set
### Keywords: methods
### ** Examples
## Load sample dataset "Master.rda"
data("Master")
## Find the most intense peak of six spectra
find_max_set(dat = Master, mass_dat = "full_mz", spectra_cols = c("After1", "Blank2",
"Before1", "Blank1", "After2", "Before2")
cleanEx()
nameEx("mapSpectrum")
### * mapSpectrum
flush(stderr()); flush(stdout())
### Name: mapSpectrum
### Title: Map Spectrum to _m/z_ Vector
### Aliases: mapSpectrum
### Keywords: array methods
### ** Examples
## Load sample dataset "Blank1.rda"
data("lank1")
## Create empty spectral data frame to map to
spec_df <- createSpecDF(min_mz = 53.76, max_mz = 1100, res = 0.0001, dig = 4)
## Map binary spectral data to empty spectral data frame
spec_df <- mapSpectrum(dat = Blank1, massCol = "mass", intenseCol = "Intensity",
spec_df = spec_df, colName = "Sample", thresh = 1e-04, dig = 4)
cleanEx()
nameEx("normMethod_RMS")
### * normMethod_RMS
flush(stderr()); flush(stdout())
### Name: norm_RMS
### Title: Normalize Spectral Intensity by Root Mean Square
### Aliases: norm_RMS
### Keywords: methods manip
### ** Examples
## Load sample dataset "Master2.rda"
data("Master2")
## Normalize spectrum "Before1" using the RMS method
ex <- normSpectra(dat = Master2, mass_dat = "full_mz", method = "RMS", spec1 = "Before1")
cleanEx()
nameEx("normMethod_TIC")
### * normMethod_TIC
flush(stderr()); flush(stdout())
### Name: norm_TIC
### Title: Normalize Peak Intensity by Total Ion Current
### Aliases: norm_TIC
### Keywords: methods manip
### ** Examples
## Load sample dataset "Master2.rda"
data("Master2")
# Normalize the TIC of "Before1" and "Before2"
ex <- normSpectra(dat = Master2, mass_dat = "full_mz", method = "TIC",
spec1 = "Before1", spec2 = "Before2")
cleanEx()
nameEx("normMethod_custom")
### * normMethod_custom
flush(stderr()); flush(stdout())
### Name: norm_custom
### Title: Normalize Peak Intensity to Custom _m/z_
### Aliases: norm_custom
### Keywords: methods manip
### ** Examples
## Load sample dataset "Master2.rda"
data("Master2")
## Normalize the intensity of peaks in "Before1" to the intensity of the peak at 255.23
ex <- normSpectra(dat = Master2, mass_dat = "full_mz", method = "custom", norm_mz = 255.23,
spec1 = "Before1")
## Normalize the intensity of peaks in 6 spectra to the intensity of the peak at 255.23
ex <- normSpectra(dat = Master2, mass_dat = "full_mz" ,method = "custom",
norm_mz = 255.23, spec1 = "Blank1", spec2 = "Blank2", spec3 = "Before1",
spec4 = "Before2", spec5 = "After1", spec6 = "After2")
cleanEx()
nameEx("normMethod_max")
### * normMethod_max
flush(stderr()); flush(stdout())
### Name: norm_max
### Title: Normalization Method: Maximum Intensity
### Aliases: norm_max
### Keywords: methods manip
### ** Examples
## Load sample dataset "Master2.rda"
data("Master2")
## Normalize intensity data for three spectra
normSpectra(dat = Master2, mass_dat = "full_mz", method = "max",
spec1 = "Blank1", spec2 = "Before1", spec3 = "After1")
cleanEx()
nameEx("normMethod_max_set")
### * normMethod_max_set
flush(stderr()); flush(stdout())
### Name: norm_max_set
### Title: Normalization Method: Maximum Intensity of Set
### Aliases: norm_max_set
### Keywords: methods manip
### ** Examples
## Load sample datasat "Master2.rda"
data("Master2")
## Normalize the intensity data of two samples to the maximum of the blank
ex <- normSpectra(dat = Master2, mass_dat = "full_mz", method = "max_set",
spec1 = "Blank1", spec2 = "Before1", spec3 = "Before2")
cleanEx()
nameEx("normMethod_median")
### * normMethod_median
flush(stderr()); flush(stdout())
### Name: norm_median
### Title: Normalize a Spectral Dataset to its Median Intensity
### Aliases: norm_median
### Keywords: methods manip
### ** Examples
## Load sample dataset "Master2.rda"
data("Master2")
## Normalize spectra "Before1" and "Before2" to their median intensity
ex <- normSpectra(dat = Master, mass_dat = "full_mz", method = "median",
spec1 = "Before1", spec2 = "Before2")
cleanEx()
nameEx("normMethod_quantile")
### * normMethod_quantile
flush(stderr()); flush(stdout())
### Name: norm_quantile
### Title: Normalize Distribution of Intensities
### Aliases: norm_quantile
### Keywords: methods manip
### ** Examples
## Load sample dataset "Master.rda"
data("Master")
## Normalize the spectra "Before1" and "Before2"
# using the quantile method
ex <- normSpectra(dat = Master, mass_dat = "full_mz", method = "quantile",
spec1 = "Before1", spec2 = "Before2")
cleanEx()
nameEx("normMethod_rel_TIC")
### * normMethod_rel_TIC
flush(stderr()); flush(stdout())
### Name: norm_rel_TIC
### Title: Normalize Relative Peak Intensity by Total Ion Current
### Aliases: norm_rel_TIC
### Keywords: methods manip
### ** Examples
## Load sample dataset "Master2.rda"
data("Master2")
# Normalize the TIC of "Before1" and "Before2"
ex <- normSpectra(dat = Master2, mass_dat = "full_mz",
method = "rel_TIC", spec1 = "Before1", spec2 = "Before2")
cleanEx()
nameEx("normMethod_stdev")
### * normMethod_stdev
flush(stderr()); flush(stdout())
### Name: norm_stdev
### Title: Normalize Spectrum to Standard Deviation of Noise
### Aliases: norm_stdev
### Keywords: methods manip
### ** Examples
## Load sample dataset "Master.rda"
data("Master")
## Normalize spectra "After1" and "After2"
# using the noisy region from m/z 900 to 1100
ex <- normSpectra(Master, mass_dat = "full_mz", method = "stdev",
lower = 900, upper = 1100, spec1 = "After1", spec2 = "After2")
cleanEx()
nameEx("normSpectra")
### * normSpectra
flush(stderr()); flush(stdout())
### Name: normSpectra
### Title: Normalize Spectral Data
### Aliases: normSpectra
### Keywords: manip methods
### ** Examples
## Load sample dataset "Master2.rda"
data("Master2")
## Normalize spectrum "Before1" to its maximum intensity
ex <- normSpectra(dat = Master2, mass_dat = "full_mz",
method = "max", spectra_cols = "Before1")
## Normalize the spectra "Before1" and "Before2" to the TIC
ex <- normSpectra(dat = Master2, mass_dat = "full_mz",
method = "TIC", spectra_cols = c("Before1", "Before2")
## Normalize spectrum "After1" to the intensity of the peak at m/z 253.22
ex <- normSpectra(dat = Master2, mass_dat = "full_mz",
method = "custom", norm_mz = 253.22, spectra_cols = "After1")
cleanEx()
nameEx("peakDet")
### * peakDet
flush(stderr()); flush(stdout())
### Name: peakDet
### Title: Peak Detection
### Aliases: peakDet
### Keywords: manip methods
### ** Examples
## Load sample dataset "bsline"
data("bsline")
## Baseline correct using method "linear"
linear <- baselineCorr(bsline, "mass", "raw",
method = "linear", n = 7)
## Detect peaks using method "snr"
snr <- peakDet(linear, "mz", "baseline", method = "snr",
n = 7, SNR_thresh = 3)
## Detect peaks using method "slopes"
slopes <- peakDet(linear, "mz", "baseline", method = "slopes",
n = 7)
cleanEx()
nameEx("plotSpectra")
### * plotSpectra
flush(stderr()); flush(stdout())
### Name: plotSpectra
### Title: Plot and Compare Spectra
### Aliases: plotSpectra
### Keywords: aplot methods
### ** Examples
## Plotting using the sample dataset "Master.rda"
data("Master")
plotSpectra(dat = Master, mass_dat = "full_mz",
spectra_cols = c("Blank1", "Blank2"),
intensity_scale = "free_y", lbls = TRUE, nrows = 2, x_ticks = 10)
cleanEx()
nameEx("read_ascii")
### * read_ascii
flush(stderr()); flush(stdout())
### Name: read_ascii
### Title: Read Raw ASCII Files
### Aliases: read_ascii
### Keywords: ascii convert data read
### ** Examples
## Converting sample ASCII file 'raw_ascii.ascii' to 'data.frame'
data("raw_ascii")
converted <- read_ascii(filename = "~/raw_ascii.ascii")
cleanEx()
nameEx("rmveEmpty")
### * rmveEmpty
flush(stderr()); flush(stdout())
### Name: rmveEmpty
### Title: Remove Empty Rows
### Aliases: rmveEmpty
### Keywords: manip methods
### ** Examples
## Load sample dataset "Mastre.rda"
data("Master")
## Select only the spectra "Before1" and "Before2"
ex <- select(Master, "full_mz", "Before1", "Before2")
## Use rmveEmpty(x) on those data frames to reduce computational load for use with
# other functions and packages
ex <- rmveEmpty(dat = ex)
cleanEx()
nameEx("smoothSpectrum")
### * smoothSpectrum
flush(stderr()); flush(stdout())
### Name: smoothSpectrum
### Title: Smooth Noise in Spectrum
### Aliases: smoothSpectrum
### Keywords: manip methods
### ** Examples
## Load sample dataset "Before1.rda"
data("Before1")
## Testing method "sgolay"
# test <- smoothSpectrum(dat = Before1, mass_dat = "mass",
#                       intensity_dat = "Intensity",
#                       method = "sgolay", p = 4,
#                       n = 25, m = 0)
## Testing method "mov_avg"
# test <- smoothSpectrum(dat = Before1, mass_dat = Before1$mass,
#                       intensity_dat = Before1$Intensity,
#                       method = "mov_avg", n = 25)
#
cleanEx()
nameEx("subSpectra")
### * subSpectra
flush(stderr()); flush(stdout())
### Name: subSpectra
### Title: Subtract Blank Peaks from Sample Spectra
### Aliases: subSpectra
### Keywords: manip methods
### ** Examples
## Load sample datasets "Master.rda"
data("Master")
## Make subtraction column for new data
Master <- transform(Master, "Subtracted" = 0)
## Subtract Blank1 from Before1
Master <- subSpectra(dat = Master, Blank_Var = "Blank1",
Sample = "Before1", Sub_Sample = "Subtracted")
### * <FOOTER>
###
cleanEx()
options(digits = 7L)
base::cat("Time elapsed: ", proc.time() - base::get("ptime", pos = 'CheckExEnv'),"\n")
grDevices::dev.off()
###
### Local variables: ***
### mode: outline-minor ***
### outline-regexp: "\\(> \\)?### [*]+" ***
### End: ***
quit('no')
